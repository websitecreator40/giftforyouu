<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>3D Lyrics Player</title>
  <style>
    html, body {
      margin: 0;
      height: 100%;
      overflow: hidden;
      background: #000;
      font-family: 'Poppins', sans-serif;
      color: white;
    }

    #container {
      width: 100vw;
      height: 100vh;
    }

    #lyrics {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      font-size: 2em;
      font-weight: 600;
      color: white;
      text-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
      transition: opacity 0.5s ease;
      opacity: 0;
      z-index: 5;
    }

    #playBtn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 20px 40px;
      border: none;
      border-radius: 12px;
      font-size: 20px;
      cursor: pointer;
      font-weight: 600;
      background: linear-gradient(90deg, #ff6bb4, #6b8bff);
      color: white;
      transition: transform 0.2s ease, background 0.3s ease;
      z-index: 10;
    }

    #playBtn:hover {
      transform: translate(-50%, -50%) scale(1.05);
    }
  </style>
</head>
<body>
  <div id="container"></div>
  <div id="lyrics"></div>
  <button id="playBtn">Play</button>
  <audio id="audio" src="song.mp3" preload="auto"></audio>

  <script src="https://unpkg.com/three@0.150.1/build/three.min.js"></script>
  <script>
    // ðŸ”¹ Lyrics lines
    const lyrics = [
      "pehela hooran barre likhde c gallan jo",
      "hun gaane tere mere utte likhan lagge ne",
      "Tu haseen tera naam haseen ay",
      "tere ishq da jaam haseen ay",
      "ye bhi matlabi zindegi",
      "zadon bhi tere nam haseen ay",
    ];

    // ðŸ”¹ 3D background
    const container = document.getElementById("container");
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, innerWidth / innerHeight, 0.1, 1000);
    camera.position.z = 5;
    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(innerWidth, innerHeight);
    container.appendChild(renderer.domElement);

    const COUNT = 3000;
    const positions = new Float32Array(COUNT * 3);
    for (let i = 0; i < COUNT * 3; i++) positions[i] = (Math.random() - 0.5) * 20;
    const geometry = new THREE.BufferGeometry();
    geometry.setAttribute("position", new THREE.BufferAttribute(positions, 3));
    const material = new THREE.PointsMaterial({ color: 0xffffff, size: 0.05 });
    const points = new THREE.Points(geometry, material);
    scene.add(points);

    let animating = false;
    function animate() {
      requestAnimationFrame(animate);
      if (animating) {
        points.rotation.y += 0.005;
        points.rotation.x += 0.002;
        material.size = 0.05 + Math.sin(Date.now() * 0.005) * 0.05;
      }
      renderer.render(scene, camera);
    }
    animate();

    // ðŸ”¹ Audio and Lyrics Control
    const audio = document.getElementById("audio");
    const playBtn = document.getElementById("playBtn");
    const lyricsDiv = document.getElementById("lyrics");

    playBtn.addEventListener("click", async () => {
      await audio.play();
      animating = true;
      playBtn.style.display = "none";
      startLyrics();
    });

    audio.addEventListener("ended", () => {
      animating = false;
      playBtn.style.display = "block";
      lyricsDiv.style.opacity = 0;
    });

    // ðŸ”¹ Manual lyrics sync (independent of duration)
    function startLyrics() {
      let index = 0;
      lyricsDiv.textContent = lyrics[index];
      lyricsDiv.style.opacity = 1;

      const interval = setInterval(() => {
        index++;
        if (index < lyrics.length) {
          lyricsDiv.style.opacity = 0;
          setTimeout(() => {
            lyricsDiv.textContent = lyrics[index];
            lyricsDiv.style.opacity = 1;
          }, 500);
        } else {
          clearInterval(interval);
        }
      }, 3000); // <-- each line changes every 3 seconds (adjust if needed)
    }

    // ðŸ”¹ Handle resize
    window.addEventListener("resize", () => {
      camera.aspect = innerWidth / innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(innerWidth, innerHeight);
    });
  </script>
</body>
</html>
