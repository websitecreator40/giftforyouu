<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>3D Lyrics Player</title>
  <style>
    html,body { margin:0; height:100%; overflow:hidden; background:#000; font-family: 'Poppins', sans-serif; color:white;}
    #container { width:100vw; height:100vh; }

    #lyrics {
      position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
      text-align:center; font-size:2em; font-weight:600;
      color:white; text-shadow:0 0 20px rgba(255,255,255,0.8);
      transition:opacity 1s ease;
      opacity:0;
    }

    #playBtn {
      position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
      padding:20px 40px; border:none; border-radius:12px; font-size:20px;
      cursor:pointer; font-weight:600;
      background:linear-gradient(90deg,#ff6bb4,#6b8bff); color:white;
      transition: transform 0.2s ease, background 0.3s ease;
      z-index:10;
    }

    #playBtn.playing {
      background:linear-gradient(90deg,#3ddc84,#00c2ff);
      transform:translate(-50%,-50%) scale(0.9);
    }
  </style>
</head>
<body>
  <div id="container"></div>
  <div id="lyrics"></div>
  <button id="playBtn">Play</button>
  <audio id="audio" src="song.mp3" preload="auto"></audio>

  <script src="https://unpkg.com/three@0.150.1/build/three.min.js"></script>
  <script>
    const lyrics = [
      "pehela hooran barre likhde c gallan jo",
      "hun gaane tere mere utte likhan lagge ne",
      "Tu haseen tera naam haseen ay",
      "tere ishq da jaam haseen ay",
      "ye bhi matlabi zindegi",
      "zadon bhi tere nam haseen ay",
    ];

    // three.js scene
    const container = document.getElementById("container");
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, innerWidth/innerHeight, 0.1, 1000);
    camera.position.z = 5;
    const renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(innerWidth, innerHeight);
    container.appendChild(renderer.domElement);

    // particles
    const COUNT = 3000;
    const positions = new Float32Array(COUNT*3);
    for(let i=0;i<COUNT*3;i++) positions[i] = (Math.random()-0.5)*20;
    const geometry = new THREE.BufferGeometry();
    geometry.setAttribute("position", new THREE.BufferAttribute(positions,3));
    const material = new THREE.PointsMaterial({color:0xffffff, size:0.05});
    const points = new THREE.Points(geometry, material);
    scene.add(points);

    let animating = false;
    function animate(){
      requestAnimationFrame(animate);
      if(animating){
        points.rotation.y += 0.005;
        points.rotation.x += 0.002;
        material.size = 0.05 + Math.sin(Date.now() * 0.005) * 0.05;
      }
      renderer.render(scene,camera);
    }
    animate();

    // audio + lyrics
    const audio = document.getElementById("audio");
    const playBtn = document.getElementById("playBtn");
    const lyricsDiv = document.getElementById("lyrics");

    let segments = [];
    audio.addEventListener("loadedmetadata", () => {
      const dur = audio.duration || 14;
      const n = lyrics.length;
      for(let i=0;i<n;i++){
        segments.push({
          text: lyrics[i],
          start: (i/n)*dur,
          end: ((i+1)/n)*dur
        });
      }
    });

    playBtn.addEventListener("click", async () => {
      await audio.play();
      animating = true;
      playBtn.style.display = "none"; // button hide
    });

    // show button again when song ends
    audio.addEventListener("ended", () => {
      playBtn.style.display = "block";
      animating = false;
      playBtn.textContent = "Play";
    });

    // show current lyric
    setInterval(()=>{
      if(!segments.length) return;
      const t = audio.currentTime;
      let active = null;
      for(let s of segments){
        if(t>=s.start && t<s.end){ active = s; break; }
      }
      if(active){
        lyricsDiv.textContent = active.text;
        lyricsDiv.style.opacity = 1;
      } else {
        lyricsDiv.style.opacity = 0;
      }
    },200);
  </script>
</body>
</html>
